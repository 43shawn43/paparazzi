<?xml version="1.0"?>

<control_panel name="paparazzi control panel">

  <section name="programs">
    <program name="Server" command="sw/ground_segment/tmtc/server"/>
    <program name="Data Link" command="sw/ground_segment/tmtc/link">
      <arg flag="-d" constant="/dev/ttyUSB0"/>
    </program>
    <program name="Link Combiner" command="sw/ground_segment/python/redundant_link/link_combiner.py"/>
    <program name="GCS" command="sw/ground_segment/cockpit/gcs">
      <arg flag="-layout" constant="large_left_col.xml"/>
    </program>
    <program name="Flight Plan Editor" command="sw/ground_segment/cockpit/gcs">
      <arg flag="-edit"/>
    </program>
    <program name="Messages" command="sw/ground_segment/tmtc/messages"/>
    <program name="Messages (Python)" command="sw/ground_segment/python/messages_app/messagesapp.py"/>
    <program name="Settings" command="sw/ground_segment/tmtc/settings">
      <arg flag="-ac" constant="@AIRCRAFT"/>
    </program>
    <program name="Settings (Python)" command="sw/ground_segment/python/settings_app/settingsapp.py">
      <arg flag="--ac_id" constant="@AC_ID"/>
    </program>
    <program name="GPSd position display" command="sw/ground_segment/tmtc/gpsd2ivy"/>
    <program name="Log Plotter" command="sw/logalizer/logplotter"/>
    <program name="Real-time Plotter" command="sw/logalizer/plotter"/>
    <program name="Real-time Plotter (Python)" command="sw/ground_segment/python/real_time_plot/realtimeplotapp.py"/>
    <program name="Log File Player" command="sw/logalizer/play"/>
    <program name="Simulator" command="sw/simulator/pprzsim-launch">
      <arg flag="-a" constant="@AIRCRAFT"/>
    </program>
    <program name="Video Synchronizer" command="sw/ground_segment/misc/video_synchronizer"/>
    <program name="Joystick" command="sw/ground_segment/joystick/input2ivy">
      <arg flag="-ac" constant="@AIRCRAFT"/>
      <arg flag="xbox_gamepad.xml"/>
    </program>
    <program name="Environment Simulator" command="sw/simulator/gaia"/>
    <program name="Http Server" command="$python">
      <arg flag="-m" constant="SimpleHTTPServer"/>
      <arg flag="8889"/>
    </program>
    <program name="Plot Meteo Profile" command="sw/logalizer/plotprofile"/>
    <program name="Weather Station" command="sw/ground_segment/misc/davis2ivy">
      <arg flag="-d" constant="/dev/ttyUSB1"/>
    </program>
    <program name="Attitude Visualizer" command="sw/tools/attitude_viz.py"/>
    <program name="App Server" command="sw/ground_segment/tmtc/app_server"/>
    <program name="NatNet" command="sw/ground_segment/misc/natnet2ivy"/>
    <program name="NatNet3" command="sw/ground_segment/python/natnet3.x/natnet2ivy.py"/>
    <program name="Ivy2Nmea" command="sw/ground_segment/tmtc/ivy2nmea">
      <arg flag="--port" constant="/dev/ttyUSB1"/>
      <arg flag="--id" constant="1"/>
    </program>
    <program name="BluegigaUsbDongleScanner" command="sw/tools/bluegiga_usb_dongle/bluegiga_usb_driver">
      <arg flag="/dev/ttyACM2"/>
      <arg flag="scan" />
    </program>
    <program name="BluegigaUsbDongle" command="sw/tools/bluegiga_usb_dongle/bluegiga_usb_driver">
      <arg flag="/dev/ttyACM2"/>
      <arg flag="00:07:00:2d:d6:bb" />
      <arg flag="4242" />
      <arg flag="4252" />
    </program>
    <program name="ADS-B Intruders receiver" command="sw/ground_segment/misc/sbs2ivy">
      <arg flag="--ac" constant="@AC_ID"/>
    </program>
    <program name="SVInfo" command="sw/ground_segment/python/svinfo/svinfo.py"/>
    <program name="IridiumDialer" command="sw/tools/iridium/iridium_link.py"/>
    <program name="PayloadForward" command="sw/ground_segment/python/payload_forward/payload.py"/>
    <program name="AeronauticalInfo" command="sw/ground_segment/python/atc/atc.py"/>
    <program name="RtpViewer" command="sw/tools/rtp_viewer/rtp_viewer.py">
      <arg flag="-p" constant="5000"/>
      <arg flag="-s" constant="0.75"/>
      <arg flag="-r" constant="3"/>
    </program>
    <program name="rtcm2ivy" command="sw/ground_segment/misc/rtcm2ivy"/>
    <program name="Link Forwarder" command="sw/ext/rustlink-forwarder/link_forwarder.sh"/>
    <program name="Ivy Logger" command="sw/ext/ivy_logger/ivyLogger.sh"/>
    <program name="Mission Planner" command="sw/ext/ivy-cpp/ivy_mission_planner.sh"/>
    <program name="FlightGear" command="sw/ext/flightgear/fgfs.sh">
      <arg flag="--fdm=null"/>
      <arg flag="--native-fdm=socket,in,30,,5501,udp"/>
      <arg flag="--prop:/sim/model/path=Models/Aircraft/paparazzi/minion.xml"/>
      <arg flag="--enable-terrasync"/>
    </program>
    <program name="RustLink" command="sw/ext/rustlink/link">
      <arg flag="-d" constant="/dev/ttyUSB0"/>
    </program>
 </section>

  <section name="sessions">

   <session name="Flight UDP/WiFi">
      <program name="Server"/>
      <program name="GCS"/>
      <program name="Data Link">
        <arg flag="-udp"/>
      </program>
    </session>

   <session name="Flight USB-serial@9600">
      <program name="Data Link">
        <arg flag="-d" constant="/dev/ttyUSB0"/>
      </program>
      <program name="Server"/>
      <program name="GCS"/>
    </session>

   <session name="Flight USB-serial@57600">
     <program name="Data Link">
       <arg flag="-d" constant="/dev/ttyUSB0"/>
       <arg flag="-s" constant="57600"/>
     </program>
     <program name="Server"/>
     <program name="GCS"/>
   </session>

   <session name="Flight USB-XBee-API@57600">
      <program name="Data Link">
        <arg flag="-d" constant="/dev/paparazzi/xbee"/>
        <arg flag="-transport" constant="xbee"/>
        <arg flag="-s" constant="57600"/>
      </program>
      <program name="Server"/>
      <program name="GCS"/>
    </session>

    <session name="Flight USB-serial Redundant">
      <program name="Server"/>
      <program name="GCS"/>
      <program name="Data Link">
        <arg flag="-d" constant="/dev/ttyUSB0"/>
        <arg flag="-id" constant="1"/>
        <arg flag="-redlink"/>
      </program>
      <program name="Data Link">
        <arg flag="-d" constant="/dev/ttyUSB1"/>
        <arg flag="-id" constant="2"/>
        <arg flag="-redlink"/>
      </program>
      <program name="Link Combiner"/>
    </session>

    <session name="SupperBitRF">
      <program name="Data Link">
        <arg flag="-d" constant="/dev/ttyACM0"/>
      </program>
      <program name="Server"/>
      <program name="GCS"/>
      <program name="Messages"/>
    </session>

    <session name="SupperBitRF cable telemetry">
      <program name="Data Link">
        <arg flag="-d" constant="/dev/ttyACM1"/>
        <arg flag="-s" constant="57600"/>
      </program>
      <program name="Server"/>
      <program name="GCS"/>
      <program name="Messages"/>
      <program name="Messages"/>
    </session>

    <session name="Messages and Settings">
      <program name="Data Link">
        <arg flag="-d" constant="/dev/ttyUSB0"/>
        <arg flag="-s" constant="57600"/>
      </program>
      <program name="Server">
        <arg flag="-n"/>
      </program>
      <program name="Messages"/>
      <program name="Settings">
        <arg flag="-ac" constant="@AIRCRAFT"/>
      </program>
    </session>

    <session name="Raw Sensors">
      <program name="Data Link">
        <arg flag="-d" constant="/dev/ttyUSB0"/>
        <arg flag="-s" constant="57600"/>
      </program>
      <program name="Server">
        <arg flag="-n"/>
      </program>
      <program name="Messages">
        <arg flag="-g" constant="300x400+0-220"/>
      </program>
      <program name="Settings">
        <arg flag="-ac" constant="@AIRCRAFT"/>
        <arg flag="-g" constant="800x200+0-0"/>
      </program>
      <program name="Real-time Plotter">
        <arg flag="-g" constant="1000x250-0+0"/>
        <arg flag="-t" constant="ACC"/>
        <arg flag="-u" constant="0.05"/>
        <arg flag="-c" constant="0.00"/>
        <arg flag="-c" constant="*:telemetry:IMU_ACCEL_RAW:ax"/>
        <arg flag="-c" constant="*:telemetry:IMU_ACCEL_RAW:ay"/>
        <arg flag="-c" constant="*:telemetry:IMU_ACCEL_RAW:az"/>
        <arg flag="-n"/>
        <arg flag="-g" constant="1000x250-0+250"/>
        <arg flag="-t" constant="GYRO"/>
        <arg flag="-u" constant="0.05"/>
        <arg flag="-c" constant="0.00"/>
        <arg flag="-c" constant="*:telemetry:IMU_GYRO_RAW:gp"/>
        <arg flag="-c" constant="*:telemetry:IMU_GYRO_RAW:gq"/>
        <arg flag="-c" constant="*:telemetry:IMU_GYRO_RAW:gr"/>
        <arg flag="-n"/>
        <arg flag="-g" constant="1000x250-0+500"/>
        <arg flag="-t" constant="MAG"/>
        <arg flag="-u" constant="0.05"/>
        <arg flag="-c" constant="0.00"/>
        <arg flag="-c" constant="*:telemetry:IMU_MAG_RAW:mx"/>
        <arg flag="-c" constant="*:telemetry:IMU_MAG_RAW:my"/>
        <arg flag="-c" constant="*:telemetry:IMU_MAG_RAW:mz"/>
        <arg flag="-n"/>
        <arg flag="-g" constant="1000x250-0+750"/>
        <arg flag="-t" constant="BARO"/>
        <arg flag="-u" constant="0.05"/>
        <arg flag="-c" constant="101325.0"/>
        <arg flag="-c" constant="*:telemetry:BARO_RAW:abs"/>
      </program>
    </session>

    <session name="Scaled Sensors">
      <program name="Data Link">
        <arg flag="-d" constant="/dev/ttyUSB0"/>
        <arg flag="-s" constant="57600"/>
      </program>
      <program name="Server">
        <arg flag="-n"/>
      </program>
      <program name="Messages">
        <arg flag="-g" constant="300x400+0-220"/>
      </program>
      <program name="Settings">
        <arg flag="-ac" constant="@AIRCRAFT"/>
        <arg flag="-g" constant="800x200+0-0"/>
      </program>
      <program name="Real-time Plotter">
        <arg flag="-g" constant="1000x250-0+0"/>
        <arg flag="-t" constant="ACC"/>
        <arg flag="-u" constant="0.05"/>
        <arg flag="-c" constant="9.81"/>
        <arg flag="-c" constant="0.00"/>
        <arg flag="-c" constant="-9.81"/>
        <arg flag="-c" constant="*:telemetry:IMU_ACCEL_SCALED:ax:0.0009766"/>
        <arg flag="-c" constant="*:telemetry:IMU_ACCEL_SCALED:ay:0.0009766"/>
        <arg flag="-c" constant="*:telemetry:IMU_ACCEL_SCALED:az:0.0009766"/>
        <arg flag="-n"/>
        <arg flag="-g" constant="1000x250-0+250"/>
        <arg flag="-t" constant="GYRO"/>
        <arg flag="-u" constant="0.05"/>
        <arg flag="-c" constant="0.00"/>
        <arg flag="-c" constant="*:telemetry:IMU_GYRO_SCALED:gp:0.0139882"/>
        <arg flag="-c" constant="*:telemetry:IMU_GYRO_SCALED:gq:0.0139882"/>
        <arg flag="-c" constant="*:telemetry:IMU_GYRO_SCALED:gr:0.0139882"/>
        <arg flag="-n"/>
        <arg flag="-g" constant="1000x250-0+500"/>
        <arg flag="-t" constant="MAG"/>
        <arg flag="-u" constant="0.05"/>
        <arg flag="-c" constant="0.00"/>
        <arg flag="-c" constant="*:telemetry:IMU_MAG_SCALED:mx:0.0004883"/>
        <arg flag="-c" constant="*:telemetry:IMU_MAG_SCALED:my:0.0004883"/>
        <arg flag="-c" constant="*:telemetry:IMU_MAG_SCALED:mz:0.0004883"/>
      </program>
    </session>


    <session name="Mission simulation: GCS and Flight Computer">
      <!-- Flight computer
            has to be compiled with the proper MODEM_HOST value
           Ivy bus on separate for for NPS messages
           bus: 127.255.255.255:2222
           port out: 4242
           port in: 4243
           - simulator, nodisplay
      -->
      <program name="Simulator">
        <arg flag="-a" constant="@AIRCRAFT"/>
        <arg flag="-b" constant="127.255.255.255:2222"/>
        <arg flag="-t" constant="nps"/>
        <arg flag="--nodisplay"/>
        <arg flag="-f" constant="127.0.0.1"/>
        <arg flag="--fg_fdm" constant=""/>
      </program>


      <!-- GCS computer
           Ivy bus on separate for for NPS messages
           has to have the broadcast IP properly set
           bus: 127.255.255.255:2010
           port out: 4244 (to Mission computer)
           port in: 4245 (from Mission computer)           
           - data  link to mission computer
           - GCS
           - server
           - messages
      -->
      <program name="Data Link">
        <arg flag="-b" constant="127.255.255.255:2010"/>
        <arg flag="-udp"/>
        <arg flag="-udp_port" constant="4244"/>
        <arg flag="-udp_uplink_port" constant="4245"/>
        <arg flag="-ping_period" constant="1000"/>
        <arg flag="-status_period" constant="1000"/>
        <arg flag="-udp_broadcast"/>
        <arg flag="-udp_broadcast_addr" constant="192.168.41.255"/>
      </program>
      <program name="Server">
        <arg flag="-b" constant="127.255.255.255:2010"/>
      </program>
      <program name="GCS">
        <arg flag="-b" constant="127.255.255.255:2010"/>
      </program>
      <program name="Messages">
        <arg flag="-c" constant="datalink"/>
        <arg flag="-c" constant="ground"/>
        <arg flag="-b" constant="127.255.255.255:2010"/>
      </program>
    </session>



    <session name="Mission simulation: Mission Computer">
      <!-- Mission computer
            data link also uses broadcast IP to reach GCS computer
           Ivy bus on separate for for NPS messages
           bus: 127.255.255.255:8484
           port out: 4243 (to Flight computer)
           port in: 4242 (from Flight computer)
           port out: 4244 (to GCS)
           port in: 4245 (from GCS)
           - data  link to flight computer
           - ivy logger
           - link forwarder to GCS
      -->
      <program name="Data Link">
        <arg flag="-b" constant="127.255.255.255:8484"/>
        <arg flag="-udp"/>
        <arg flag="-udp_port" constant="4242"/>
        <arg flag="-udp_uplink_port" constant="4243"/>
        <arg flag="-udp_broadcast"/>
        <arg flag="-udp_broadcast_addr" constant="192.168.41.255"/>
      </program>

      <program name="Ivy Logger">
        <arg flag="-b" constant="127.255.255.255:8484"/>
      </program>

      <program name="Mission Planner">
        <arg flag="-b" constant="127.255.255.255:8484"/>
        <arg flag="-a" constant="2"/>
        <!-- for evil mode: arg flag="-e" / -->
      </program>

      <!-- Rethink the incoming ports for the evil mode-->
      <program name="RustLink">
        <arg flag="-b" constant="127.255.255.255:8484"/>
        <arg flag="--udp"/>
        <arg flag="--udp_port" constant="4245"/>
        <arg flag="--udp_uplink_port" constant="4244"/>
        <arg flag="--rx_msg_class" constant="datalink"/>
        <arg flag="--sender_id" constant="2"/>
        <arg flag="--ping_period" constant="0"/>
        <arg flag="--status_period" constant="0"/>
        <arg flag="-v" constant="1.0"/>
        <arg flag="-n" constant="LINK_FORWARDER"/>
        <arg flag="-r" constant="192.168.41.255"/>
        <arg flag="--udp_broadcast"/>
      </program>
    </session>

    <session name="Mission simulation: All in one">
      <!-- Flight computer
           Ivy bus on separate for for NPS messages
           bus: 127.255.255.255:2222
           port out: 4242
           port in: 4243
           - simulator, nodisplay
      -->
      <program name="Simulator">
        <arg flag="-a" constant="@AIRCRAFT"/>
        <arg flag="-b" constant="127.255.255.255:2222"/>
        <arg flag="-t" constant="nps"/>
        <arg flag="--nodisplay"/>
        <arg flag="-f" constant="127.0.0.1"/>
        <arg flag="--fg_fdm" constant=""/>
      </program>

      <!-- Mission computer
           Ivy bus on separate for for NPS messages
           bus: 127.255.255.255:8484
           port out: 4243 (to Flight computer)
           port in: 4242 (from Flight computer)
           port out: 4244 (to GCS)
           port in: 4245 (from GCS)
           - data  link to flight computer
           - ivy logger
           - link forwarder to GCS
      -->
      <program name="RustLink">
        <arg flag="-b" constant="127.255.255.255:8484"/>
        <arg flag="--udp"/>
        <arg flag="--udp_port" constant="4242"/>
        <arg flag="--udp_uplink_port" constant="4243"/>
        <arg flag="--ping_period" constant="0"/>
        <arg flag="--status_period" constant="0"/>
        <arg flag="--sender_id" constant="0"/>
        <arg flag="-v" constant="1.0"/>
        <arg flag="-n" constant="MISSION_LINK"/>
      </program>

      <program name="Ivy Logger">
        <arg flag="-b" constant="127.255.255.255:8484"/>
      </program>

      <program name="Mission Planner">
        <arg flag="-b" constant="127.255.255.255:8484"/>
        <arg flag="-a" constant="2"/>
      </program>

      <program name="RustLink">
        <arg flag="-b" constant="127.255.255.255:8484"/>
        <arg flag="--udp"/>
        <arg flag="--udp_port" constant="4245"/>
        <arg flag="--udp_uplink_port" constant="4244"/>
        <arg flag="--rx_msg_class" constant="datalink"/>
        <arg flag="--sender_id" constant="2"/>
        <arg flag="--ping_period" constant="0"/>
        <arg flag="--status_period" constant="0"/>
        <arg flag="-v" constant="1.0"/>
        <arg flag="-n" constant="LINK_FORWARDER"/>
      </program>

      <!-- GCS computer
           Ivy bus on separate for for NPS messages
           bus: 127.255.255.255:2010
           port out: 4244 (to Mission computer)
           port in: 4245 (from Mission computer)           
           - data  link to mission computer
           - GCS
           - server
           - messages
      -->
      <program name="RustLink">
        <arg flag="-b" constant="127.255.255.255:2010"/>
        <arg flag="--udp"/>
        <arg flag="--udp_port" constant="4244"/>
        <arg flag="--udp_uplink_port" constant="4245"/>
        <arg flag="--ping_period" constant="1000"/>
        <arg flag="--status_period" constant="1000"/>
        <arg flag="-v" constant="1.0"/>
        <arg flag="-n" constant="DATALINK"/>
      </program>
      <program name="Server">
        <arg flag="-b" constant="127.255.255.255:2010"/>
      </program>
      <program name="GCS">
        <arg flag="-b" constant="127.255.255.255:2010"/>
      </program>
      <program name="Messages">
        <arg flag="-c" constant="datalink"/>
        <arg flag="-c" constant="ground"/>
        <arg flag="-b" constant="127.255.255.255:2010"/>
      </program>
    </session>



<session name="Mission simulation: All in one (Localhost only)">
      <!-- Flight computer
           Ivy bus on separate for for NPS messages
           bus: 127.255.255.255:2222
           port out: 4242
           port in: 4243
           - simulator, nodisplay
      -->
      <program name="Simulator">
        <arg flag="-a" constant="@AIRCRAFT"/>
        <arg flag="-b" constant="127.255.255.255:2222"/>
        <arg flag="-t" constant="nps"/>
        <arg flag="--nodisplay"/>
        <arg flag="-f" constant="127.0.0.1"/>
        <arg flag="--fg_fdm" constant=""/>
      </program>

      <!-- Mission computer
           Ivy bus on separate for for NPS messages
           bus: 127.255.255.255:8484
           port out: 4243 (to Flight computer)
           port in: 4242 (from Flight computer)
           port out: 4244 (to GCS)
           port in: 4245 (from GCS)
           - data  link to flight computer
           - ivy logger
           - link forwarder to GCS
      -->
      <program name="Data Link">
        <arg flag="-b" constant="127.255.255.255:8484"/>
        <arg flag="-udp"/>
        <arg flag="-udp_port" constant="4242"/>
        <arg flag="-udp_uplink_port" constant="4243"/>
        <arg flag="-ping_period" constant="1000"/>
        <arg flag="-status_period" constant="1000"/>
      </program>

      <program name="Ivy Logger">
        <arg flag="-b" constant="127.255.255.255:8484"/>
      </program>

      <program name="Mission Planner">
        <arg flag="-b" constant="127.255.255.255:8484"/>
        <arg flag="-a" constant="2"/>
      </program>

      <program name="Link Forwarder">
        <arg flag="-b" constant="127.255.255.255:8484"/>
        <arg flag="-d" constant="4245"/>
        <!-- 22 for evil mode -->
        <arg flag="-u" constant="4244"/>
      </program>

      <!-- GCS computer
           Ivy bus on separate for for NPS messages
           bus: 127.255.255.255:2010
           port out: 4244 (to Mission computer)
           port in: 4245 (from Mission computer)           
           - data  link to mission computer
           - GCS
           - server
           - messages
      -->
      <program name="Data Link">
        <arg flag="-b" constant="127.255.255.255:2010"/>
        <arg flag="-udp"/>
        <arg flag="-udp_port" constant="4244"/>
        <arg flag="-udp_uplink_port" constant="4245"/>
        <arg flag="-ping_period" constant="1000"/>
        <arg flag="-status_period" constant="1000"/>
      </program>
      <program name="Server">
        <arg flag="-b" constant="127.255.255.255:2010"/>
      </program>
      <program name="GCS">
        <arg flag="-b" constant="127.255.255.255:2010"/>
      </program>
      <program name="Messages">
        <arg flag="-c" constant="datalink"/>
        <arg flag="-c" constant="ground"/>
        <arg flag="-b" constant="127.255.255.255:2010"/>
      </program>
    </session>


  </section>

</control_panel>
